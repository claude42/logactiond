dovecot:
{
	// The source file which is scanned for matching lines
	source = "syslog";
	// List of patterns to match source file for. If one of the patterns
	// matches a line, this results in one trigger.
	//
	// In matching lines, content that matches  %SOMETHING% tokens will be
	// used to replace the corresponding token in the action strings.
	pattern = (
		"(pop3|imap)-login: (Disconnected|Aborted login)(: Inactivity)? \(tried to use disallowed plaintext auth\): user=<[-_.@[:alnum:]]*>, rip=%HOST%, lip=[.[:digit:]]+(, session=<[[:alnum:]\+\/]+>)?$",
		"(Info|dovecot: auth\(default\)|auth-worker\(\d+\)): pam\(\S+,%HOST%\): pam_authenticate\(\) failed: (User not known to the underlying authentication module: \d+ Time\(s\)|Authentication failure \(password mismatch\?\))\s*$",
		"(auth|auth-worker\(\d+\)): (pam|passwd-file)\(\S+,%HOST%\): unknown user\s*$",
		"(auth|auth-worker\(\d+\)): Info: ldap\(\S*,%HOST%,\S*\): invalid credentials\s*$",
		"(pop3|imap)-login: Disconnected \(no auth attempts in \d+ secs\):( user=<[^>]*>,)?( method=\S+,)? rip=%HOST%(, lip=\S+)?(, TLS)?( handshaking: SSL_accept\(\) syscall failed: Connection reset by peer)?(, session=<\S+>)?\s*$"
	);
	// Service name used for syslog
	service = "dovecot"
	// Which systemd unit must match - in case we're using systemd
	systemd-unit = "dovecot.service";
	// In addition to the tokens matched in the pattern, additional
	// properties can be specified here which will also be used during
	// substitution of the corresponding tokens in the action strings.
	//
	// Look up the definition of the desired actions to see which
	// properties it expects.
	properties:
	{
		PROTOCOL = "tcp";
		PORT="pop3,pop3s,imap,imaps,submission,465,sieve";
	}
}
